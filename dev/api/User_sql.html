<html><head><title>Module User_sql </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/></head><body class="User_sql dev"><h1>Module <span><a href=".././api/User_sql">User_sql</a></span> </h1><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span class="ocsforge_color_uid"><span class="ocsforge_color_uid">User_sql</span></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a href=".././api/User_sql">..</a></span><span class="ocsforge_color_keyword">end</span></pre><p>The abstract type of user ids
</p><hr/><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span><a href=".././api/User_sql.Types">Types</a></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a href=".././api/User_sql.Types">..</a></span><span class="ocsforge_color_keyword">end</span></pre><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONNotAnUser"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">NotAnUser</span></pre><div class="odocwiki_info"><p>Exception raised when a string cannot be translated into a real user</p></div><pre class="ocsforge_color odocwiki_code" id="VALnew_user"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">new_user</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">password:</span><span><a href=".././api/User_sql.Types#TYPEpwd">Types.pwd</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">fullname:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">email:</span>string option <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">dyn:</span>bool <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span><span><a href=".././api/User_sql.Types#TYPEuserid">Types.userid</a></span> * <span><a href=".././api/User_sql.Types#TYPEpwd">Types.pwd</a></span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Creates a user. The password passed as argument must be unencrypted.
Returns the user id and its password after an eventual encryption.</p></div><pre class="ocsforge_color odocwiki_code" id="VALnew_parameterized_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">new_parameterized_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">prefix:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">descr:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">find_param:</span><span><a href=".././api/User_sql.Types#TYPEfind_param">Types.find_param</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  'a <span><a href=".././api/User_sql.Types#TYPEparameterized_group">Types.parameterized_group</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALnew_nonparameterized_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">new_nonparameterized_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">prefix:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">descr:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONNotBasicUser"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">NotBasicUser</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserdata">Types.userdata</a></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALget_basicuser_by_login"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_basicuser_by_login</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserid">Types.userid</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALget_basicuser_data"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_basicuser_data</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserid">Types.userid</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserdata">Types.userdata</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALget_parameterized_user_data"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_parameterized_user_data</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  'a <span><a href=".././api/User_sql.Types#TYPEparameterized_group">Types.parameterized_group</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserdata">Types.userdata</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALget_user_data"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_user_data</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserdata">Types.userdata</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALgroups_of_user"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">groups_of_user</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_label">user:</span><span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> list <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Returns the groups in which a user is directly included</p></div><pre class="ocsforge_color odocwiki_code" id="VALusers_in_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">users_in_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?generic:</span>bool <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">group:</span><span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> list <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Returns the users or groups inside a group. If <span class="odocwiki_inlinecode">generic</span> is false,
inclusions coming from generic edges are not returned</p></div><pre class="ocsforge_color odocwiki_code" id="VALadd_to_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">add_to_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_label">user:</span><span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">group:</span><span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALremove_from_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">remove_from_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_label">user:</span><span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">group:</span><span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALadd_generic_inclusion"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">add_generic_inclusion</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">subset:</span>'a <span><a href=".././api/User_sql.Types#TYPEparameterized_group">Types.parameterized_group</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">superset:</span>'a <span><a href=".././api/User_sql.Types#TYPEparameterized_group">Types.parameterized_group</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALadd_to_group_generic"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">add_to_group_generic</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">user:</span>'a <span><a href=".././api/User_sql.Types#TYPEparameterized_group">Types.parameterized_group</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">group:</span>'a <span><a href=".././api/User_sql.Types#TYPEparameterized_group">Types.parameterized_group</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Same as <span class="odocwiki_inlinecode">add_generic_inclusion</span>. Use the one you prefer.</p></div><pre class="ocsforge_color odocwiki_code" id="VALdelete_user"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">delete_user</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_label">userid:</span><span><a href=".././api/User_sql.Types#TYPEuserid">Types.userid</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALupdate_data"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">update_data</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">userid:</span><span><a href=".././api/User_sql.Types#TYPEuserid">Types.userid</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?password:</span><span><a href=".././api/User_sql.Types#TYPEpwd">Types.pwd</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?fullname:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?email:</span>string option <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">?dyn:</span>bool <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALuserid_to_string"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">userid_to_string</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserid">Types.userid</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Converts an <span class="odocwiki_inlinecode">userid</span> to a string, by giving the corresponding
login field. Raises <span class="odocwiki_inlinecode">Not_found</span> if the user does not exists.</p></div><pre class="ocsforge_color odocwiki_code" id="VALuser_to_string"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">user_to_string</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_label">?expand_param:</span>bool <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Converts an user to a string. Basic users are converted as
per <span class="odocwiki_inlinecode">userid_to_string</span>. Groups are written  <span class="odocwiki_inlinecode">#group(val)</span>
where <span class="odocwiki_inlinecode">group</span> is the name used at the creation
of the group, and val is the <span class="odocwiki_inlinecode">int32</span> parameter of the group.
If <span class="odocwiki_inlinecode">expand_param</span> is <span class="odocwiki_inlinecode">true</span> the function tries to convert <span class="odocwiki_inlinecode">int32</span> into
a string, using the functions passed as arguments when <span class="odocwiki_inlinecode">#group</span> was
defined.</p></div><pre class="ocsforge_color odocwiki_code" id="VALget_user_by_name"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_user_by_name</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Returns the user that corresponds to a given string
(inverse of the function <span class="odocwiki_inlinecode">user_to_string</span>, or raises
<span class="odocwiki_inlinecode">Not_found</span> if the user does not exists</p></div><pre class="ocsforge_color odocwiki_code" id="VALall_users"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">all_users</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEusers">Types.users</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Returns a list of all the existing users and groups.</p></div><pre class="ocsforge_color odocwiki_code" id="VALuser_type"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">user_type</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuser">Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> [ `Group | `Role | `User ] <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><p>Users settings
</p><pre class="ocsforge_color odocwiki_code" id="TYPEuser_settings"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">user_settings</span> <span class="ocsforge_color_delimiter">=</span> <span class="ocsforge_color_delimiter">{</span>
<span class="odocwiki_record"><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">basicusercreation:</span> <span class="odocwiki_type">bool</span><span class="ocsforge_color_delimiter">;</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">registration_mail_from:</span> <span class="odocwiki_type">string</span><span class="ocsforge_color_delimiter">;</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">registration_mail_addr:</span> <span class="odocwiki_type">string</span><span class="ocsforge_color_delimiter">;</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">registration_mail_subject:</span> <span class="odocwiki_type">string</span><span class="ocsforge_color_delimiter">;</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">groups:</span> <span class="odocwiki_type">string</span><span class="ocsforge_color_delimiter">;</span></span></span><span class="odocwiki_field"><span class="odocwiki_field_descr">  <span class="ocsforge_color_label">non_admin_can_create:</span> <span class="odocwiki_type">bool</span><span class="ocsforge_color_delimiter">;</span></span></span></span><span class="ocsforge_color_delimiter">}</span></pre><pre class="ocsforge_color odocwiki_code" id="VALget_users_settings"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_users_settings</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql#TYPEuser_settings">user_settings</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALset_users_settings"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">set_users_settings</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql#TYPEuser_settings">user_settings</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALget_users_login"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_users_login</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  unit <span class="ocsforge_color_delimiter">-&gt;</span><br/>  &lt; id : &lt; get : unit; nul : <span class="ocsforge_color_uid">Sql</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">non_nullable</span>; t : <span class="ocsforge_color_uid">Sql</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">int32_t</span> &gt; <span class="ocsforge_color_uid">Sql</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span>;<br/>    title : &lt; get : unit; nul : <span class="ocsforge_color_uid">Sql</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">nullable</span>; t : <span class="ocsforge_color_uid">Sql</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">string_t</span> &gt; <span class="ocsforge_color_uid">Sql</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span> &gt;<br/>  list <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre></body></html>
