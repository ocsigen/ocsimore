<html><head><title>Module User </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/></head><body class="User dev"><h1>Module <span><a href=".././api/User">User</a></span> </h1><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span class="ocsforge_color_uid"><span class="ocsforge_color_uid">User</span></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a href=".././api/User">..</a></span><span class="ocsforge_color_keyword">end</span></pre><p>Module Users.
</p><p>Users, authentication, protection.
</p><p>In this model, users and groups are the same concept. A group can
belong to another group. We only distinguish, for practical
matters, between &quot;login enabled&quot; users and &quot;group only&quot; users: the
former has <span class="odocwiki_inlinecode">Some</span> (eventually void) password, the latter has
<span class="odocwiki_inlinecode">None</span>.
</p><hr/><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONConnectionRefused"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">ConnectionRefused</span></pre><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONBadPassword"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">BadPassword</span></pre><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONBadUser"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">BadUser</span></pre><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONUnknownUser"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">UnknownUser</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type">string</span></pre><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONUseAuth"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">UseAuth</span> <span class="ocsforge_color_keyword">of</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALanonymous"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">anonymous</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span></span></pre><div class="odocwiki_info"><p>Non authenticated users</p></div><pre class="ocsforge_color odocwiki_code" id="VALanonymous_login"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">anonymous_login</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string</span></pre><pre class="ocsforge_color odocwiki_code" id="VALadmin"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">admin</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span></span></pre><div class="odocwiki_info"><p>A user that belongs to all groups</p></div><pre class="ocsforge_color odocwiki_code" id="VALadmin_login"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">admin_login</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string</span></pre><pre class="ocsforge_color odocwiki_code" id="VALnobody"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">nobody</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span></span></pre><div class="odocwiki_info"><p>A user/group that does not belong to any group,  and in which nobody
can be.</p></div><pre class="ocsforge_color odocwiki_code" id="VALnobody_login"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">nobody_login</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string</span></pre><pre class="ocsforge_color odocwiki_code" id="VALauthenticated_users"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">authenticated_users</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span></span></pre><div class="odocwiki_info"><p>A group containing all authenticated users (not groups)</p></div><pre class="ocsforge_color odocwiki_code" id="VALgroup_can_create_groups"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">group_can_create_groups</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span></span></pre><div class="odocwiki_info"><p>The groups of users that can create new groups</p></div><pre class="ocsforge_color odocwiki_code" id="VALgroup_can_create_users"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">group_can_create_users</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span></span></pre><div class="odocwiki_info"><p>Same thing with users</p></div><pre class="ocsforge_color odocwiki_code" id="VALgroup_can_admin_users"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">group_can_admin_users</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span></span></pre><div class="odocwiki_info"><p>The groups of users that can modify the users settings</p></div><pre class="ocsforge_color odocwiki_code" id="VALgroup_can_admin_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">group_can_admin_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">[ `User ] <span><a href=".././api/User_sql.Types#TYPEparameterized_group">User_sql.Types.parameterized_group</a></span></span></pre><div class="odocwiki_info"><p>The group of users that can add or remove people in the given user/group</p></div><pre class="ocsforge_color odocwiki_code" id="VALget_basicuser_by_login"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_basicuser_by_login</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Information about a user. Return <span class="odocwiki_inlinecode">nobody</span> if the user
does not currently exists, and raises <span class="odocwiki_inlinecode">User_sql.NotBasicUser</span>
if the user does not correspond to a basic user.</p></div><pre class="ocsforge_color odocwiki_code" id="VALget_user_by_name"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_user_by_name</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Returns the user that corresponds to a given string
(inverse of the function <span class="odocwiki_inlinecode">User_sql.user_to_string</span>,
or nobody if the user does not exists</p></div><pre class="ocsforge_color odocwiki_code" id="VALuser_list_of_string"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">user_list_of_string</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> list <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Convert a list of string representation of users into the
corresponding users, according to <span class="odocwiki_inlinecode">get_user_by_name</span>. Nobody
is never returned. Fails with <span class="odocwiki_inlinecode">UnknownUser u</span> if the user
<span class="odocwiki_inlinecode">u</span> is not recognized</p></div><pre class="ocsforge_color odocwiki_code" id="VALcreate_user"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">create_user</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">pwd:</span><span><a href=".././api/User_sql.Types#TYPEpwd">User_sql.Types.pwd</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">fullname:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?email:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?test:</span><span class="ocsforge_color_delimiter">(</span>unit <span class="ocsforge_color_delimiter">-&gt;</span> bool <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Creates a new user or group with given parameters,
or returns the existing user without modification
if <span class="odocwiki_inlinecode">name</span> is already present.</p></div><pre class="ocsforge_color odocwiki_code" id="VALcreate_fresh_user"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">create_fresh_user</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">pwd:</span><span><a href=".././api/User_sql.Types#TYPEpwd">User_sql.Types.pwd</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">fullname:</span>string <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?email:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Same as above, except that the function will raise <span class="odocwiki_inlinecode">BadUser</span> if
the user already exists</p></div><pre class="ocsforge_color odocwiki_code" id="VALcreate_external_user"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">create_external_user</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Same as create_user, but only for external users</p></div><pre class="ocsforge_color odocwiki_code" id="VALauthenticate"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">authenticate</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">name:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">pwd:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserdata">User_sql.Types.userdata</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALadd_to_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">add_to_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">user:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">group:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Atomic change in one group</p></div><pre class="ocsforge_color odocwiki_code" id="VALremove_from_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">remove_from_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">user:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">group:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALadd_to_groups"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">add_to_groups</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">user:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">groups:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Multiple operations on groups</p></div><pre class="ocsforge_color odocwiki_code" id="VALadd_list_to_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">add_list_to_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">l:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">group:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALremove_list_from_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">remove_list_from_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">l:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> list <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">group:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALin_group"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">in_group</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?user:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">group:</span><span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_delimiter">-&gt;</span> bool <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><p>Informations on the loggued user
</p><pre class="ocsforge_color odocwiki_code" id="VALget_user_data"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_user_data</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserdata">User_sql.Types.userdata</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALget_user_id"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_user_id</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALget_user_name"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get_user_name</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> string <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALis_logged_on"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">is_logged_on</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> bool <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALset_session_data"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">set_session_data</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a href=".././api/User_sql.Types#TYPEuserid">User_sql.Types.userid</a></span> * string <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code" id="VALuser_from_userlogin_xform"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">user_from_userlogin_xform</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  string <span class="ocsforge_color_delimiter">-&gt;</span> <span><a href=".././api/User_sql.Types#TYPEuser">User_sql.Types.user</a></span> <span><a href=".././api/Xform#TYPEconvert">Xform.convert</a></span> <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span><a href=".././api/User.GenericRights">GenericRights</a></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a href=".././api/User.GenericRights">..</a></span><span class="ocsforge_color_keyword">end</span></pre></body></html>
