=Module <<a_api_type | module Wikiperso >> =
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<span class="ocsforge_color_uid"|<<span class="ocsforge_color_uid"|Wikiperso>>>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api text=".." | module Wikiperso >><<span class="ocsforge_color_keyword"|end>>>>**Author(s):** Vincent Balat, Boris Yakobowski\\

----

~Wikiperso is an eliom extension that can be used to provide
    personal wikis~. ~That is~, when the user accesses a page
    such as webserver~.org~/~~bla~/foo~, a personal wiki is created
    for the user bla~, and registered to the url ~~bla

~Wikiperso currently takes two config options ~(in this order~)
* username is a regexp with one parameter~, which must
    extract from an url the name of the user for which the
    wiki must be created~, or fail if no wiki must be created~.

* wikiroot is a regexp containing the string ~$~U~S~E~R~. ~Replacing ~$~U~S~E~R
    by the user for which the wiki must be created must result
    in the root url for this wiki ~(of course relative to the current
    eliom root url~)~. ~Correct values could be <<span class="odocwiki_inlinecode"|~~~$~U~S~E~R>> or <<span class="odocwiki_inlinecode"|perso~/~$~U~S~E~R>>

    ~An example configuration is given below


    ~<eliommodule module~="~/path~/to~/wikiperso~.cmo"~>
      ~<options username~="~~~(<<span class="odocwiki_inlinecode"|~^~/>>~* ~)~.~*" wikiroot~="~~~$~U~S~E~R" ~/~>
    ~<~/eliommodule~>
<<pre id="VALextract_user_name" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|extract~_user~_name>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> string option>>>><<pre id="VALwiki_path" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|wiki~_path>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> string list>>>><<pre id="VALexternal_user" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|external~_user>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >> option <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>>
~Template pages~, for the containers and the css of the new wikis~. ~They are
    copied each time a new wiki is created
<<pre id="VALdefault_welcome_page" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|default~_welcome~_page>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string>>>><<pre id="VALdefault_wikicss" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|default~_wikicss>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string>>>><<pre id="VALtemplate_container_pagename" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|template~_container~_pagename>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string>>>><<pre id="VALtemplate_css_pagename" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|template~_css~_pagename>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string>>>><<pre id="VALtemplate_container" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|template~_container>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> string <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALtemplate_wiki_css" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|template~_wiki~_css>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> string <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALcreate_wikiperso" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|create~_wikiperso>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| model: >><<a_api text="Wiki_types.wiki_model" | type Wiki_types.wiki_model >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| wiki_title: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| userdata: >><<a_api text="User_sql.Types.userdata" | type User_sql.Types.userdata >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Wiki_types.wiki" | type Wiki_types.wiki >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~The function that creates the wikiperso when needed
>>
<<pre id="VALfind_user" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|find~_user>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >> option <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALcan_have_wikiperso" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|can~_have~_wikiperso>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.user" | type User_sql.Types.user >>>>>><<pre id="VALcannot_have_wikiperso" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|cannot~_have~_wikiperso>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.user" | type User_sql.Types.user >>>>>><<pre id="VALf_can_have_wikiperso" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|f~_can~_have~_wikiperso>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> bool <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre class="ocsforge_color odocwiki_code"|<<span name="TYPEwikiperso_rights"|<<span class="ocsforge_color_keyword"|class>> <<a_api text="wikiperso_rights" | class Wikiperso.wikiperso_rights >>>> <<span class="ocsforge_color_delimiter"|~:>>  <<span class="ocsforge_color_keyword"|object>><<a_api text=".." | class Wikiperso.wikiperso_rights >><<span class="ocsforge_color_keyword"|end>>>><<pre id="VALwikiperso_rights" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|wikiperso~_rights>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="wikiperso_rights" | class type Wikiperso.wikiperso_rights >>>>>><<pre id="VALwikiperso_model" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|wikiperso~_model>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="Wiki_types.wiki_model" | type Wiki_types.wiki_model >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALgen" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|gen>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_uid"|Ocsigen_extensions>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|answer>> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~The function that answers for the extension~.
>>
<<pre id="VALusers_root" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|users~_root>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_delimiter"| ( >>unit, unit, [< <<span class="ocsforge_color_uid"|Eliom_service>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|service_method>> > `Get ],\\   [< <<span class="ocsforge_color_uid"|Eliom_service>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|attached>> > `Attached ],\\   [< <<span class="ocsforge_color_uid"|Eliom_service>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|service_kind>> > `Service ], [ `WithoutSuffix ], \\   unit, unit, [< <<span class="ocsforge_color_uid"|Eliom_service>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|registrable>> > `Registrable ],\\   [> <<span class="ocsforge_color_uid"|Eliom_service>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|appl_service>> ]<<span class="ocsforge_color_delimiter"| ) >>\\  <<span class="ocsforge_color_uid"|Eliom_service>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|service>>>>>>