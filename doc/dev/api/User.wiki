=Module <<a_api_type | module User >> =
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<span class="ocsforge_color_uid"|<<span class="ocsforge_color_uid"|User>>>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api text=".." | module User >><<span class="ocsforge_color_keyword"|end>>>>~Module ~Users~.


    ~Users~, authentication~, protection~.


    ~In this model~, users and groups are the same concept~. ~A group can
    belong to another group~. ~We only distinguish~, for practical
    matters~, between "login enabled" users and "group only" users~: the
    former has <<span class="odocwiki_inlinecode"|~Some>> ~(eventually void~) password~, the latter has
    <<span class="odocwiki_inlinecode"|~None>>~.

----
<<pre id="EXCEPTIONConnectionRefused" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|ConnectionRefused>>>><<pre id="EXCEPTIONBadPassword" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|BadPassword>>>><<pre id="EXCEPTIONBadUser" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|BadUser>>>><<pre id="EXCEPTIONUnknownUser" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|UnknownUser>> <<span class="ocsforge_color_keyword"|of>> <<span class="odocwiki_type"|string>>>><<pre id="EXCEPTIONUseAuth" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|UseAuth>> <<span class="ocsforge_color_keyword"|of>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >>>>>><<pre id="VALanonymous" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|anonymous>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >>>>>><<div class="odocwiki_info"|~Non authenticated users
>>
<<pre id="VALanonymous_login" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|anonymous~_login>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string>>>><<pre id="VALadmin" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|admin>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >>>>>><<div class="odocwiki_info"|~A user that belongs to all groups
>>
<<pre id="VALadmin_login" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|admin~_login>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string>>>><<pre id="VALnobody" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|nobody>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >>>>>><<div class="odocwiki_info"|~A user~/group that does not belong to any group~,  and in which nobody
    can be~.
>>
<<pre id="VALnobody_login" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|nobody~_login>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string>>>><<pre id="VALauthenticated_users" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|authenticated~_users>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >>>>>><<div class="odocwiki_info"|~A group containing all authenticated users ~(not groups~)
>>
<<pre id="VALgroup_can_create_groups" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|group~_can~_create~_groups>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.user" | type User_sql.Types.user >>>>>><<div class="odocwiki_info"|~The groups of users that can create new groups
>>
<<pre id="VALgroup_can_create_users" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|group~_can~_create~_users>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.user" | type User_sql.Types.user >>>>>><<div class="odocwiki_info"|~Same thing with users
>>
<<pre id="VALgroup_can_admin_users" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|group~_can~_admin~_users>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.user" | type User_sql.Types.user >>>>>><<div class="odocwiki_info"|~The groups of users that can modify the users settings
>>
<<pre id="VALgroup_can_admin_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|group~_can~_admin~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|[ `User ] <<a_api text="User_sql.Types.parameterized_group" | type User_sql.Types.parameterized_group >>>>>><<div class="odocwiki_info"|~The group of users that can add or remove people in the given user~/group
>>
<<pre id="VALget_basicuser_by_login" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_basicuser~_by~_login>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Information about a user~. ~Return <<span class="odocwiki_inlinecode"|nobody>> if the user
    does not currently exists~, and raises <<span class="odocwiki_inlinecode"|~User~_sql~.~Not~Basic~User>>
    if the user does not correspond to a basic user~.
>>
<<pre id="VALget_user_by_name" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_user~_by~_name>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Returns the user that corresponds to a given string
    ~(inverse of the function <<span class="odocwiki_inlinecode"|~User~_sql~.user~_to~_string>>~,
    or nobody if the user does not exists
>>
<<pre id="VALuser_list_of_string" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|user~_list~_of~_string>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.user" | type User_sql.Types.user >> list <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Convert a list of string representation of users into the
    corresponding users~, according to <<span class="odocwiki_inlinecode"|get~_user~_by~_name>>~. ~Nobody
    is never returned~. ~Fails with <<span class="odocwiki_inlinecode"|~Unknown~User u>> if the user
    <<span class="odocwiki_inlinecode"|u>> is not recognized
>>
<<pre id="VALcreate_user" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|create~_user>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| name: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| pwd: >><<a_api text="User_sql.Types.pwd" | type User_sql.Types.pwd >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| fullname: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?email: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?test: >><<span class="ocsforge_color_delimiter"| ( >>unit <<span class="ocsforge_color_delimiter"| -> >> bool <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>><<span class="ocsforge_color_delimiter"| ) >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Creates a new user or group with given parameters~,
    or returns the existing user without modification
    if <<span class="odocwiki_inlinecode"|name>> is already present~.
>>
<<pre id="VALcreate_fresh_user" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|create~_fresh~_user>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| name: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| pwd: >><<a_api text="User_sql.Types.pwd" | type User_sql.Types.pwd >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| fullname: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?email: >>string <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Same as above~, except that the function will raise <<span class="odocwiki_inlinecode"|~Bad~User>> if
    the user already exists
>>
<<pre id="VALcreate_external_user" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|create~_external~_user>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Same as create~_user~, but only for external users
>>
<<pre id="VALauthenticate" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|authenticate>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| name: >>string <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| pwd: >>string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userdata" | type User_sql.Types.userdata >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALadd_to_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|add~_to~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| user: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| group: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Atomic change in one group
>>
<<pre id="VALremove_from_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|remove~_from~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| user: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| group: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALadd_to_groups" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|add~_to~_groups>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| user: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| groups: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> list <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Multiple operations on groups
>>
<<pre id="VALadd_list_to_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|add~_list~_to~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| l: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> list <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| group: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALremove_list_from_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|remove~_list~_from~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| l: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> list <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| group: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALin_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|in~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?user: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| group: >><<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> bool <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>>
~Informations on the loggued user
<<pre id="VALget_user_data" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_user~_data>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userdata" | type User_sql.Types.userdata >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALget_user_id" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_user~_id>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALget_user_name" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_user~_name>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> string <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALis_logged_on" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|is~_logged~_on>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> bool <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALset_session_data" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_session~_data>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="User_sql.Types.userid" | type User_sql.Types.userid >> * string <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALuser_from_userlogin_xform" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|user~_from~_userlogin~_xform>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="User_sql.Types.user" | type User_sql.Types.user >> <<a_api text="Xform.convert" | type Xform.convert >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<a_api text="GenericRights" | module User.GenericRights >> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api text=".." | module User.GenericRights >><<span class="ocsforge_color_keyword"|end>>>>