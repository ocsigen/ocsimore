=Module <<a_api_type | module User_sql >> =
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<span class="ocsforge_color_uid"|<<span class="ocsforge_color_uid"|User_sql>>>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api text=".." | module User_sql >><<span class="ocsforge_color_keyword"|end>>>>~The abstract type of user ids

----
<<pre class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|module>> <<a_api text="Types" | module User_sql.Types >> <<span class="ocsforge_color_delimiter"|~:>> <<span class="ocsforge_color_keyword"|sig>><<a_api text=".." | module User_sql.Types >><<span class="ocsforge_color_keyword"|end>>>><<pre id="EXCEPTIONNotAnUser" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|NotAnUser>>>><<div class="odocwiki_info"|~Exception raised when a string cannot be translated into a real user
>>
<<pre id="VALnew_user" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|new~_user>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| name: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| password: >><<a_api text="Types.pwd" | type User_sql.Types.pwd >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| fullname: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| email: >>string option <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| dyn: >>bool <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_delimiter"| ( >><<a_api text="Types.userid" | type User_sql.Types.userid >> * <<a_api text="Types.pwd" | type User_sql.Types.pwd >><<span class="ocsforge_color_delimiter"| ) >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Creates a user~. ~The password passed as argument must be unencrypted~.
    ~Returns the user id and its password after an eventual encryption~.
>>
<<pre id="VALnew_parameterized_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|new~_parameterized~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| prefix: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| name: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| descr: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| find_param: >><<a_api text="Types.find_param" | type User_sql.Types.find_param >> <<span class="ocsforge_color_delimiter"| -> >>\\  'a <<a_api text="Types.parameterized_group" | type User_sql.Types.parameterized_group >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALnew_nonparameterized_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|new~_nonparameterized~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| prefix: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| name: >>string <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| descr: >>string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="EXCEPTIONNotBasicUser" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|exception>> <<span class="odocwiki_name"|NotBasicUser>> <<span class="ocsforge_color_keyword"|of>> <<span class="odocwiki_type"|<<a_api text="Types.userdata" | type User_sql.Types.userdata >>>>>><<pre id="VALget_basicuser_by_login" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_basicuser~_by~_login>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALget_basicuser_data" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_basicuser~_data>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.userdata" | type User_sql.Types.userdata >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALget_parameterized_user_data" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_parameterized~_user~_data>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  'a <<a_api text="Types.parameterized_group" | type User_sql.Types.parameterized_group >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.userdata" | type User_sql.Types.userdata >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALget_user_data" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_user~_data>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.userdata" | type User_sql.Types.userdata >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALgroups_of_user" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|groups~_of~_user>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_label"| user: >><<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.user" | type User_sql.Types.user >> list <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Returns the groups in which a user is directly included
>>
<<pre id="VALusers_in_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|users~_in~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| ?generic: >>bool <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| group: >><<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.user" | type User_sql.Types.user >> list <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Returns the users or groups inside a group~. ~If <<span class="odocwiki_inlinecode"|generic>> is false~,
    inclusions coming from generic edges are not returned
>>
<<pre id="VALadd_to_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|add~_to~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_label"| user: >><<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| group: >><<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALremove_from_group" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|remove~_from~_group>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_label"| user: >><<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| group: >><<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALadd_generic_inclusion" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|add~_generic~_inclusion>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| subset: >>'a <<a_api text="Types.parameterized_group" | type User_sql.Types.parameterized_group >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| superset: >>'a <<a_api text="Types.parameterized_group" | type User_sql.Types.parameterized_group >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALadd_to_group_generic" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|add~_to~_group~_generic>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| user: >>'a <<a_api text="Types.parameterized_group" | type User_sql.Types.parameterized_group >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| group: >>'a <<a_api text="Types.parameterized_group" | type User_sql.Types.parameterized_group >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Same as <<span class="odocwiki_inlinecode"|add~_generic~_inclusion>>~. ~Use the one you prefer~.
>>
<<pre id="VALdelete_user" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|delete~_user>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_label"| userid: >><<a_api text="Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALupdate_data" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|update~_data>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  <<span class="ocsforge_color_label"| userid: >><<a_api text="Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?password: >><<a_api text="Types.pwd" | type User_sql.Types.pwd >> <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?fullname: >>string <<span class="ocsforge_color_delimiter"| -> >>\\  <<span class="ocsforge_color_label"| ?email: >>string option <<span class="ocsforge_color_delimiter"| -> >> <<span class="ocsforge_color_label"| ?dyn: >>bool <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALuserid_to_string" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|userid~_to~_string>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="Types.userid" | type User_sql.Types.userid >> <<span class="ocsforge_color_delimiter"| -> >> string <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Converts an <<span class="odocwiki_inlinecode"|userid>> to a string~, by giving the corresponding
    login field~. ~Raises <<span class="odocwiki_inlinecode"|~Not~_found>> if the user does not exists~.
>>
<<pre id="VALuser_to_string" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|user~_to~_string>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<span class="ocsforge_color_label"| ?expand_param: >>bool <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> string <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Converts an user to a string~. ~Basic users are converted as
    per <<span class="odocwiki_inlinecode"|userid~_to~_string>>~. ~Groups are written  <<span class="odocwiki_inlinecode"|~#group~(val~)>>
    where <<span class="odocwiki_inlinecode"|group>> is the name used at the creation
    of the group~, and val is the <<span class="odocwiki_inlinecode"|int~3~2>> parameter of the group~.
    ~If <<span class="odocwiki_inlinecode"|expand~_param>> is <<span class="odocwiki_inlinecode"|true>> the function tries to convert <<span class="odocwiki_inlinecode"|int~3~2>> into
    a string~, using the functions passed as arguments when <<span class="odocwiki_inlinecode"|~#group>> was
    defined~.
>>
<<pre id="VALget_user_by_name" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_user~_by~_name>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|string <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Returns the user that corresponds to a given string
    ~(inverse of the function <<span class="odocwiki_inlinecode"|user~_to~_string>>~, or raises
    <<span class="odocwiki_inlinecode"|~Not~_found>> if the user does not exists
>>
<<pre id="VALall_users" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|all~_users>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="Types.users" | type User_sql.Types.users >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<div class="odocwiki_info"|~Returns a list of all the existing users and groups~.
>>
<<pre id="VALuser_type" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|user~_type>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="Types.user" | type User_sql.Types.user >> <<span class="ocsforge_color_delimiter"| -> >> [ `Group | `Role | `User ] <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>>
~Users settings
<<pre class="ocsforge_color odocwiki_code" id="TYPEuser_settings"|<<span class="ocsforge_color_keyword"|type>> <<span class="odocwiki_name"|user~_settings>> <<span class="ocsforge_color_delimiter"|~=>> <<span class="ocsforge_color_delimiter"|~{>>
<<span class="odocwiki_record"|<<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|basicusercreation:>> <<span class="odocwiki_type"|bool>><<span class="ocsforge_color_delimiter"|~;>> >>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|registration_mail_from:>> <<span class="odocwiki_type"|string>><<span class="ocsforge_color_delimiter"|~;>> >>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|registration_mail_addr:>> <<span class="odocwiki_type"|string>><<span class="ocsforge_color_delimiter"|~;>> >>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|registration_mail_subject:>> <<span class="odocwiki_type"|string>><<span class="ocsforge_color_delimiter"|~;>> >>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|groups:>> <<span class="odocwiki_type"|string>><<span class="ocsforge_color_delimiter"|~;>> >>>><<span class="odocwiki_field"|<<span class="odocwiki_field_descr"|  <<span class="ocsforge_color_label"|non_admin_can_create:>> <<span class="odocwiki_type"|bool>><<span class="ocsforge_color_delimiter"|~;>> >>>>>><<span class="ocsforge_color_delimiter"|~}>>>><<pre id="VALget_users_settings" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_users~_settings>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|unit <<span class="ocsforge_color_delimiter"| -> >> <<a_api text="user_settings" | type User_sql.user_settings >> <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALset_users_settings" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|set~_users~_settings>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|<<a_api text="user_settings" | type User_sql.user_settings >> <<span class="ocsforge_color_delimiter"| -> >> unit <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>><<pre id="VALget_users_login" class="ocsforge_color odocwiki_code"|<<span class="ocsforge_color_keyword"|val>> <<span class="odocwiki_name"|get~_users~_login>> <<span class="ocsforge_color_delimiter"|~:>> <<span class="odocwiki_type"|\\  unit <<span class="ocsforge_color_delimiter"| -> >>\\  < id : < get : unit; nul : <<span class="ocsforge_color_uid"|Sql>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|non_nullable>>; t : <<span class="ocsforge_color_uid"|Sql>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|int32_t>> > <<span class="ocsforge_color_uid"|Sql>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>;\\    title : < get : unit; nul : <<span class="ocsforge_color_uid"|Sql>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|nullable>>; t : <<span class="ocsforge_color_uid"|Sql>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|string_t>> > <<span class="ocsforge_color_uid"|Sql>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>> >\\  list <<span class="ocsforge_color_uid"|Lwt>><<span class="ocsforge_color_delimiter"| . >><<span class="ocsforge_color_lid"|t>>>>>>